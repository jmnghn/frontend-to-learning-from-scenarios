## 독립 저장소 vs. 모노레포

```
1. 모노레포의 필요성
2. stateofjs
```

### 모노레포의 필요성

회사 규모가 커지면 프로젝트도 엄청 많이 생기고 그에 따라서 프로덕트들도 엄청 많이 생긴다.<br />
각각의 프로덕트들이 여러 팀에 배분 되어서 개발하고 운영하게 되는데, 그렇게 긴 리파지토리가 많이 생기고 프로젝트 셋업이 많이 됐을 때 우리가 지금까지도 그렇게 해왔듯이 컴포넌트가 공통 컴포넌트로 빼고 라이브러리도 여러 군데에서 사용할 수 있는 것들은 리파지토리로 빼고 이런 식으로 운영이 되어 왔는데 그랬을 때 생기는 문제들이 있다. '그 컴포넌트나 라이브러리들은 어느 팀에서 관리하게 되는가?'<br />

일반 라이브러리와 다르게 UI 컴포넌트 라이브러리 같은 경우에는 어떤 특정 팀이 A라는 컴포넌트를 쓰고 있다가 그 A라는 컴포넌트가 수정되어야 하는 경우에 그 컴포넌트의 리포를 수정해야 되는데, 만약에 권한이 없다고 그러면 그걸 권한이 있는 팀한테 요청하고 그것들을 커뮤니케이션하고 하면 당연히 속도가 느려질 수밖에 없다. 회사 규모가 엄청 크면 당연히 보수화되고 프로세스가 추가적으로 많이 생기고, 팀도 많아지고 팀 간 협업을 해야 되는 거니까 속도가 느려질 수밖에 없다. 그런데 그럼에도 불구하고 '요즘 같은 세상에 빠르게 디벨롭하고 커뮤니케이션도 간소하게 됐으면 좋겠어. 최소한 기술적인 엔지니어링 분야에선 말이야.'라고 하는 화두가 있고, 그렇게 하려면 어떻게 해야 하는가라는 이야기다.<br />

우리만 해도 지금 현재 샘플만 하더라도 리파지토리가 얼마나 많은가. 백엔드 사이드만 벌써 여섯 개, 그리고 클라이언트 사이드도 있고 라이브러리도 있고 웹 애플리케이션도 지금 엄청나게 많은 리포가 있다.<br />

<img width="240" src="https://user-images.githubusercontent.com/19165916/196337117-3646d246-44fe-49b5-8d29-f8819e3f496c.png">

각각의 개별적인 프로젝트 이고, 실제 프로덕션 환경, 실제 회사라고 하면 수십 개는 아주 우습고, 수백 개까지 될 수 있을 것이다. 그런데 그게 웹 애플리케이션이라고 하는 범주로만 모아 놓아도 엄청나게 많은 리포들이 있을 텐데, 그런 것들을 독립된 리포로 운용하는 게 효율적이지 못하다. 왜냐하면 빌드나 혹은 CI 같은 것들을 연동할 때 혹은 린트나 이런 여러 가지 공통사항들을 통일되게 적용하고 싶은데 그것들을 커뮤니케이션으로 적용한다는 건 쉬운 일이 아니다. 그래서 아예 물리적으로 하나로 합쳐놓으면 어떨까라고 하는 시도들을 굉장히 많이 한다. 그게 바로 '모노레포'라고 할 수 있다.

<br />

## stateofjs

모노레포와 관련해서는 여러 가지 도구들이 존재한다.<br />
여기 지금 링크에는 작년 기준의 데이터인데 [State of JavaScript](https://2021.stateofjs.com/en-US/libraries/monorepo-tools/)를 보면 모노레포 툴들을 랭킹을 메겨놨다.<br />

'특별하게 새로운 도구를 도입하고 싶지 않아' 라고 하면, npm이나 yarn을 그냥 사용해서 모노레포를 구축해도 되고, 하나의 리포에다가 '워크스페이스'란 개념을 두고선 저런 프로젝트들을 하위로 두는 것이다. 그러면 자연스럽게 공통 프로젝트 같은 것들을 접근하기도 좋고, 유지보수하기도 훨씬 더 유용하고 팀 간 커뮤니케이션 하기도 좋다. 그리고 킷 커밋로그에 모든 히스토리가 다 있기 때문에 다른 팀이 유지보수한다고 하더라도 어떤 식으로 변화되어 가고 있는지 추적하기도 훨씬 쉽다라고 하는 것. 그래서 모노레포를 한번 시도해 보면 좋겠다 싶다.<br />

이것도 개인적인 의견이지만 초기에 레포가 10개 미만인 경우에도 모노레포를 한번 시도해보면 좋을 것 같다. 왜냐하면 모노레포를 실제로 운용을 해보면 어떤 식으로 팀마다 다른 배포 주기를 이 모노레포에서 브랜치 전략을 가져갈 것인가 그리고 업데이트를 할 때 어떤 프로세스로 어떤 규약으로 업데이트 할 것인가? 공통으로 어떻게 적용할 것인가?와 같은 류의 회사마다 프로토콜을 좀 정해야 하는 것들이 있다. 굉장히 많이 생기는데 그런 규약들을 엄청 거대하게 리포가 한 50개쯤 생겼을 때, '우리 모노레포를 한번 해봅시다'라고 하면 정해야 될 게 한 두개가 아니다. 그래서 시작도 못하고 지쳐 떨어지는 경우들이 있는데, 아주 작은 단위에서 시작하고 하나하나 문제가 생겼을 때, 프로세스를 수립해 나간다고 하면 훨씬 향후에 규모가 커질 때도 당연히 손쉽게 기존에 이미 룰셋을 만들어놨기 때문에 그 룰 셋 범위 내에서 없는 것들만 정의하고 나가면 되니까 훨씬 더 규모를 키우기가 용이할것이라 생각한다. 그런 맥락에서 규모가 작을 떄부터도 모노레포 도입을 한번 생각해보고, 이 모노레포가 극단적으로는 플랫폼이 다른 웹 애플리케이션 이라든가 백엔드 사이드 애플리케이션 혹은 앱이나 이런 것들을 모두 다 모아놓은 회사도 있다고 한다. 그런데 그렇게 쓸 때 얼마나 효과적일지는 잘 모르겠다. 오히려 복잡도 때문에 여러 가지 문제들이 생길 수 있지 않을까하는 생각을 한다. 그러니까 어떻게 보면 프론트엔드만이라도 하나의 모노레포로 구성해서 그 안에서 효과적으로 운영할 수 있는 방법들을 한번 찾아보고, 운영 노하우들을 한번 쌓아보면 좋을것 같다.<br />
오픈되어 있는 정보만 가지고 모든 걸 체득할 수는 없다. 실제로 운영해보면서 몸으로 부딪쳐가면서 얻어야 되는 것들도 굉장히 많기 때문에 그런 부분들을 직접 해보지 않으면, 경험해 보지 않으면 알 수 없는 부분들이기 때문에 한 번 시도해보고, 자신만의 노하우를 쌓아 보면 좋을 것 같다.<br />

모노레포는 개인적으로 생각해봤을 때, 최근의 트렌드로 보면 선택이 아니라 필수가 아닌가 싶다. 그러니까 먼저 시도해보고 경험을 쌓아 보면 성장에 훨씬 도움이 될 것이다.
